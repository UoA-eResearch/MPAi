<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="https://cdn.plot.ly/plotly-2.31.1.min.js" charset="utf-8"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"
    integrity="sha512-dfX5uYVXzyU8+KHqj8bjo7UkOdg18PaOtpa48djpNbZHwExddghZ+ZmzWT06R5v6NSk3ZUfsH6FNEDepLx9hPQ=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script type="text/javascript" src="forest.js"></script> <!-- Formant Estimator -->
  <script type="text/javascript" src="ksvF0.js"></script> <!-- Pitch Detector F0 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-iYQeCzEYFbKjA/T2uDLTpkwGzCiq6soy8tYaI1GyVh/UjpbCx/TYkiZhlZB6+fzT" crossorigin="anonymous">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.1/jquery.min.js"
    integrity="sha512-aVKKRRi/Q/YV+4mjoKBsE4x3H+BkegoM/em46NNlCqNTmUYADjBbeNefNxYV7giUp0VxICtqdrbqU7iVaeZNXA=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.9.1/font/bootstrap-icons.css">
  <script src="recorder.js"></script>
  <script src="https://unpkg.com/alpinejs" defer></script>
  <link rel="stylesheet" href="style.css">
  <title>MPAi.js</title>
  <script type="text/javascript">
    /**
     * Returns all steps in the flow.
     * 
    */
    function getPages(){
      return [
        {name: "welcome"},
        {name: "audiopermission"}, 
        {name:"model"}
      ]
    }

    document.addEventListener('alpine:init', () => {
        Alpine.data('pageState', () => ({
            currentPage: getPages()[0],

            previousStep() {
              const allPages = getPages();
              for (var i = 0; i < allPages.length; i++){
                const page = allPages[i];
                if (page.name === this.currentPage.name) {
                  // We are on the right page.
                  this.currentPage = allPages[i-1];
                  break;
                }
              }
            },
 
            nextStep() {
              const allPages = getPages();
              for (var i = 0; i < allPages.length; i++){
                const page = allPages[i];
                if (page.name === this.currentPage.name) {
                  // We are on the right page.
                  this.currentPage = allPages[i+1];
                  break;
                }
              }
            }
        }))
    })

  </script>
  
</head>

<body>
<div class="container d-flex flex-column" id="doc" x-data="pageState">
  <div id="top-controls" class="py-4 mb-3" x-show="currentPage.name != 'welcome'">
  <a href="#" @click="previousStep()" class="icon-link">
    <svg role="img" aria-label="Back to previous screen" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-arrow-left text-secondary" viewBox="0 0 16 16">
      <path fill-rule="evenodd" d="M15 8a.5.5 0 0 0-.5-.5H2.707l3.147-3.146a.5.5 0 1 0-.708-.708l-4 4a.5.5 0 0 0 0 .708l4 4a.5.5 0 0 0 .708-.708L2.707 8.5H14.5A.5.5 0 0 0 15 8"/>
    </svg>
    </a>
  </div>
  <!-- <div class="flex-fill"> -->
    <div class="flex-fill" x-html="(await (await fetch('pages/welcome.html')).text())" x-show="currentPage.name == 'welcome'" x-transition></div>
    <div class="flex-fill" x-html="(await (await fetch('pages/audiopermission.html')).text())" x-show="currentPage.name == 'audiopermission'" x-transition></div>
  <!-- </div> -->
  <div id="bottom-controls" class="mb-3 d-grid col-6 mx-auto">
    <a @click="nextStep()" id="btn-continue" class="d-block btn btn-primary">Continue</a>
  </div>
</div>
</body>

</html>